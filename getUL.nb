(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      9802,        255]
NotebookOptionsPosition[      9081,        226]
NotebookOutlinePosition[      9416,        241]
CellTagsIndexPosition[      9373,        238]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "Nobs_", ",", "Nbg_", ",", "Nsig_", ",", "NErr_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       FractionBox[
        RowBox[{"Nbg", "+", "Nsig"}], 
        RowBox[{
         SqrtBox["2"], "NErr"}]], "]"}]}], ")"}], 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"PoissonDistribution", "[", "x", "]"}], ",", "Nobs"}], "]"}], 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"Nbg", "+", "Nsig"}], ",", "NErr"}], "]"}], ",", "x"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pval", "[", 
   RowBox[{"Nobs_", ",", "Nsig_", ",", "NErr_", ",", "Nbg_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", " ", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"x", ",", "Nobs", ",", "Nbg", ",", "Nsig", ",", "NErr"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0.", ",", "Infinity"}], "}"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.632843731714764*^9, 3.632843798968824*^9}, {
  3.632843857337277*^9, 3.632843938418269*^9}, {3.6328439969460697`*^9, 
  3.6328441490910397`*^9}, {3.632844195846084*^9, 3.632844289702548*^9}, {
  3.632844362998218*^9, 3.632844371973866*^9}, {3.632844406706098*^9, 
  3.632844408846347*^9}, {3.632845520915701*^9, 3.632845531335989*^9}, {
  3.634310639176181*^9, 3.634310661335904*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nobs", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbg", " ", "=", " ", "17.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nErr", "=", "3.2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.632843942596191*^9, 3.632843981223605*^9}, {
   3.6328441617441874`*^9, 3.632844168686618*^9}, 3.632844200510734*^9, {
   3.632844391005628*^9, 3.6328443921797647`*^9}, {3.632844686874814*^9, 
   3.632844687867301*^9}, {3.633285070722642*^9, 3.633285075933601*^9}, {
   3.634310105155326*^9, 3.6343101084594803`*^9}, {3.634311884679151*^9, 
   3.634311896167129*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n0", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"nobs", "-", "nbg", " ", "-", " ", 
       RowBox[{"4", 
        SqrtBox[
         RowBox[{"nbg", " ", "+", " ", 
          RowBox[{"nErr", "^", "2"}]}]]}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"nobs", "-", "nbg", " ", "+", " ", 
       RowBox[{"4", 
        SqrtBox[
         RowBox[{"nbg", " ", "+", " ", 
          RowBox[{"nErr", "^", "2"}]}]]}]}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.633285088803237*^9, 3.633285126042199*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Pval", "[", 
  RowBox[{"nobs", ",", "n0", ",", "nErr", ",", "nbg"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Pval", "[", 
  RowBox[{"nobs", ",", "n1", ",", "nErr", ",", "nbg"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6328441795990973`*^9, 3.63284420810201*^9}, {
   3.6328447233079557`*^9, 3.632844734692696*^9}, {3.632844828156073*^9, 
   3.632844859539967*^9}, {3.632845163845261*^9, 3.632845170327972*^9}, {
   3.632845336201223*^9, 3.632845337343771*^9}, 3.632845523814602*^9, {
   3.633285132808494*^9, 3.633285140636408*^9}}],

Cell[BoxData["0.370462225585572`"], "Output",
 CellChangeTimes->{{3.632844209657619*^9, 3.632844294301296*^9}, {
   3.6328443671212873`*^9, 3.6328444108625717`*^9}, 3.632844692408269*^9, 
   3.6328447356472*^9, 3.63284486090311*^9, 3.632845170905245*^9, 
   3.632845338054516*^9, {3.63284552434352*^9, 3.6328455330776176`*^9}, 
   3.633285161528921*^9, 3.6343101181534357`*^9, {3.6343106484858093`*^9, 
   3.634310664057107*^9}, 3.634311906705206*^9}],

Cell[BoxData["0.0003075763736748879`"], "Output",
 CellChangeTimes->{{3.632844209657619*^9, 3.632844294301296*^9}, {
   3.6328443671212873`*^9, 3.6328444108625717`*^9}, 3.632844692408269*^9, 
   3.6328447356472*^9, 3.63284486090311*^9, 3.632845170905245*^9, 
   3.632845338054516*^9, {3.63284552434352*^9, 3.6328455330776176`*^9}, 
   3.633285161528921*^9, 3.6343101181534357`*^9, {3.6343106484858093`*^9, 
   3.634310664057107*^9}, 3.63431190671941*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Pval", "[", 
      RowBox[{"nobs", ",", "x", ",", "nErr", ",", "nbg"}], "]"}], ",", 
     "0.05"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1.", ",", "10."}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.633285163945077*^9, 3.633285209067284*^9}, {
  3.634310128710002*^9, 3.6343101331334457`*^9}, {3.634311912593141*^9, 
  3.634311915600914*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwVz3k41AkYwPFpamyacU+SJoxfKpXSanPmfVOaPIlabLR0KE2XtT2p7D5l
hYmU6DdMrqxjRGFcs6mlQgY1SGbZwy07DVEzRK7Y9o/v8/n7y/YP+jaASqFQ
9n7pf/9S7d1MoSih4oNnouMuGdRpFsW60ZUQxR39c+cOGZSt1x5K01cCLdLA
ew/K4FZAa5athRI8Gox0fOxksOPv75jnDyqBIRg7cWmjDERVhz/9K1aC22Vx
3jN9GfDizj2RnlKB+HZaRejbVvjaItHljmwUbKiSxkfXW4F9NKCEPjAOsWYn
PFqrX0NF3CLdyKpJOMId0AmlvwahhppV+q0ZSO3te/7GtwVMI+OzE5PnQKLs
6D2/+xXcmw6+tvsRBbsHK+Qtk03A2yTv3+JExT8ktBO6dxqBcTPaeLR2ITLN
i0zmnaUwGEB6l1jQkOPWby1hvgTtyiO2PWI1dNh37GSPrAFi4wT6WqaLkdPA
rq4vqYfSmM8yrWh1NMxlj3DS64BNNbf9hUHHgeBL71yuSEA+UZGivMjA9DTK
IUVILYxz9YQt8xqot0WNIz75HAooabFXr2oh7Hd7fINbA770OtuUYG1kzVCD
UsOqIdozg5JvrYPE+8AF4rgqOOwrklSO6GBjr0XHqaBn8H1WejetTBd5yzM4
e0VPYP3lXG55sB7qGYzF2yyuhBzmwPtT5kzkWMSdnbj1Ozi/o770GGGitUa1
NOarxxAf5pXtKFyKbhsE5o4PykF0v2r49gF91C1jWiX4P4RRbc0YluEyHLW5
MGyn9Rv0bY0zy3u1DKcyVbnOfWUwnjLKPJNggHMvsg4k3i+FLvKHYIHXcrS/
Hrez61oJBLkYtdaoG6K7983mwchiWONYHLG6yRA5ip9+tp4QQYzqgtWNiBXo
sMRqYptxIVTZeHp4b2WhRoflNu7JfGA9Zdb7TrJwpu2tnlx4Hwiquq1/4Uq0
c8h8qlyaB+6RPXPp54zw3Spj/+bL92C1ZLCmc60xBksjtdr0cqAlmfEpvNMY
L6l5zfXUZsO+9mgodjdBjRQM6QzMAk3ICf/1gQnSZGv9piETuutKg9ZpsLHQ
TZHXRs+ApKTGhMFANgpUJtzdPXchz4Via97Axqhs1hXOcCq8XG4WtWidKQa7
JlimfUgGpxfHPI/wTHFNk7u+aHMSCGtEPspuU6T/uI3wEgjAoGNoMQsJpK7q
zA8fS4D+VrRuSCEQh05HbODxIX3tHn2/NALN1u3jzYbywSfUa1x1l8Bx76vO
zSF8aDE/XbYik0Cp9er5i2f58DSMvykol8DPEUzXLg8+pG6Ur9EXE6h+N1Y1
a8oHz5gbBsebCPTfIBTwakjQ7k38NNlMYGDWyuSblSRIv8loj20hMIQx6Zr4
kASnPnFCuYzA/oKt9fkPSLC06dam/0Pgiz1F08MkCQy5pXqpnMCq8IBFVcdI
aLC3V+xSEBgVbjLS50dCxG3n+o5BAt8U9YTRvEmYdjjIo418+c1uy93vSoKC
H7HAZ4zAo2Pxis9bSBAOxvaOfCTQetzPyGITCYch6Vn4BIHFSrVZP3MS2ocK
rhRMEaj50aewdiUJJJb7bp8hcEhsFza9jAQ3QbV9+yyBh/qOT23WJWHJsNTw
zByB6+fPG5xhkCDZ3j41P0+gQLiwK0eNhP8AJq4//g==
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwf7WTNBYKV9a3/h3tOZH+F8I92pntMv
f4LzFRNTN3I/+Qrn7+5nEWo58APOX8LLZjyv7zecr9QyYfHUmf/g/GW/Sto8
djA4wO3Tf/bIxIkJzufp6ZD/dIQZzn+ZOilioy4rnC+wJ8Hy/hY2OL+3f5oY
vxIHnL+p6+9l/g5OOF+RSdOynocbzn/2bfesD2U8cP7XdOElF/7zwvlrGOb0
Njbyw/kx3McsZ5UIwPkdIQsYVpsLwvnxMeuO7nmL4EcvmnePdbMQnK9dszx9
e4kwnL9U5Mm7TE0RON/1NdOp4LcI/oSG0MV2S0Th/HUrD7yZGC4G538S4OuS
kRKH8x+a9auuOI/gf531SSR7igScf3dSXsm0UEk4P99T7tIhTik4X91uQ7Pa
WQS/62OpcXezNJx/wCIkOMJMBs6X2SdyPOYHgq/MxGmZtFYWzvdvuf9vXqEc
nK929OWhOxrycP6FmTzfm+4g+AHXOuw3+CvA+Xz2S5vmr0Lw7x3blK/Fqwjn
z5hxZsrLXAR/hSeDpeYJBP+UpGo7i5YSnO90MjkkoRXBX3JoXeSHewi+xO1X
HDIOynD+o0sO5idmIfghXd0SKWcR/KOO137+/4/gAwDglJ34
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{2., 0.02},
  Method->{},
  PlotRange->{{1., 10.}, {0.0176034847399121, 0.3011623819654649}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.633285185702524*^9, 3.633285212727495*^9}, 
   3.6343101342398777`*^9, {3.634310653168063*^9, 3.63431066524699*^9}, {
   3.6343119102562037`*^9, 3.6343119165351877`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pval", "[", 
  RowBox[{"nobs", ",", 
   RowBox[{"0.48", " ", "20.5"}], ",", "nErr", ",", "nbg"}], "]"}]], "Input",
 CellChangeTimes->{{3.6343101509399347`*^9, 3.63431019221955*^9}, {
  3.634311936080119*^9, 3.634311946983201*^9}}],

Cell[BoxData["0.018776466179537512`"], "Output",
 CellChangeTimes->{{3.63431015941289*^9, 3.6343101968123417`*^9}, {
  3.634310656505467*^9, 3.634310666192326*^9}, {3.634311937856451*^9, 
  3.634311947336294*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.634310335728416*^9, 3.634310351773554*^9}}]
},
WindowSize->{1301, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1545, 40, 115, "Input"],
Cell[2105, 62, 619, 12, 77, "Input"],
Cell[2727, 76, 713, 23, 91, "Input"],
Cell[CellGroupData[{
Cell[3465, 103, 561, 10, 55, "Input"],
Cell[4029, 115, 451, 6, 32, "Output"],
Cell[4483, 123, 454, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4974, 134, 455, 12, 32, "Input"],
Cell[5432, 148, 3031, 57, 250, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8500, 210, 254, 5, 32, "Input"],
Cell[8757, 217, 213, 3, 65, "Output"]
}, Open  ]],
Cell[8985, 223, 92, 1, 32, "Input"]
}
]
*)

(* End of internal cache information *)
